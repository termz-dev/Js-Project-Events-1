<!DOCTYPE html>
<html lang="en">
<head>
    <title>Upload Profile Picture</title>
</head>
<body>
    <h2>Upload Profile Picture</h2>
    <form id="uploadform">
         <input type="text" id="image" placeholder="Image URL" required />
        <button type="submit">Upload</button>
        <button type="submit">create an event</button>

    </form>

    <button id="logoutBtn">Logout</button>


    <script type="module">
  // Import the functions you need from the SDKs you need
  import { auth, db } from "./firebase.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";
  import { doc, getDoc, setDoc, updateDoc } 
from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  const uploadform = document.getElementById('uploadform');
  const img = document.getElementById('image');
  const myLogoutBtn = document.getElementById('logoutBtn');

  onAuthStateChanged(auth, async (user) => {
    if (!user) {
      window.location.href = 'login.html';
      return;
    }

    

    uploadform.addEventListener('submit', async (e) => {
      e.preventDefault();
      const docRef = doc(db, 'users', user.uid);
    const docSnap = await getDoc(docRef);
      try {
        if (docSnap.exists()) {
          const userData = docSnap.data();
          userData.photoURL = img.value;
          await updateDoc(docRef, {
            photoURL: img.value
          })
          alert('Profile picture updated successfully!');
          window.location.href = 'dashboard.html';
        }
      } catch (error) {
        console.error('Error updating profile picture:', error);
      }
    });
    });

  


 // logout 
  myLogoutBtn.addEventListener('click', async () => {
    try {
      await signOut(auth);
      alert('Logout Successful');
      window.location.href = 'login.html';
    } catch (error) {
      console.error('Error logging out:', error);
    }
  });


  
</script>
</body>
</html>